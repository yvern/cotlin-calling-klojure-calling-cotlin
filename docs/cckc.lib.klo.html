<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" content="text/html" http-equiv="Content-Type" />
		<meta content="An example of using a library written in Clojure from Kotlin" name="description" />
		<title>Interfacing Clojure and Kotlin</title>
		<link href="https://fonts.googleapis.com/css?family=Montserrat&display=swap" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="css/sidenotes.css" />
 		<link rel="stylesheet" type="text/css" href="css/shCore.css" />
		<link rel="stylesheet" type="text/css" href="css/shThemeSidenotes.css" />
		<style type="text/css">.syntaxhighlighter{overflow:hidden !important;}</style>
		<script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
		<script type="text/javascript" src="js/xregexp-min.js"></script>
		<script type="text/javascript" src="js/shCore.js"></script>
		<script type="text/javascript" src="js/shBrushClojure.js"></script>
	</head>
	<body>
		<div class="gridlayout">
			<div class="box header">
				<h1 class="project-name">cckc.lib.klo</h1>
				<a class="toc-link" href="index.html">table of contents</a>
			</div>
			<div class="box section">
				<p><code>:gen-class</code> form ensures this namespace outputs a class that can be used from Kotlin (or any jvm language)  the value after <code>:methods</code> is to be a vec of public methods and their signatures</p><p> unfortunately, we need to provide the full path/name of the types/interfaces/classes,  even while importing them, maybe because of aliasing and making sure we get the right ones.  </p><p> the <code>:name</code> key makes the generated class have a name other than the current namespace.</p><p> the method parameters are to be in the vector, the second element, and lastly the return type.  no return value requires the type java.lang.Void  </p><p> the name of exported methods should match functions in the current namespace (after the '-'),  and this is how they are seen from Java  </p><p> <code>gen-class</code> allows for a 'prefix' to be used, that would be placed before the '-' on the function names,  by default it is empty (''). personally i would disencourage to use it,  as we all recognize <code>-main</code> as mapping to <code>public static void main</code>, so as static methods on our class</p>
			</div>
			<div class="box section">
				<pre class="brush: clojure">(ns cckc.lib.klo
  (:require [clojure.pprint :refer [print-table]])
  (:import (java.util List Map)
           (java.util.function Function))
  (:gen-class
   :name cckc.lib.Klo
   :methods [^{:static true}
             [funky [java.util.List java.util.function.Function]
              java.util.Map]
             ^{:static true}
             [printer [java.util.List]
              java.lang.String]]))</pre>
			</div>
						<div class="box section">
				<p>Here we would like to be aware of reflection, which can degrade performance. Type hints are here to stop that</p>
			</div>
			<div class="box section">
				<pre class="brush: clojure">(set! *warn-on-reflection* true)</pre>
			</div>
						<div class="box section">
				<p>Given a closure filling the Java Function interface and an url,  reads the content of the url,   </p><p> and applies (via <code>.apply</code>) the given closure,  builds a histogram and returns the top 10 results</p>
			</div>
			<div class="box section">
				<pre class="brush: clojure">(defn top-chars
  [^Function f url]
  (-&gt;&gt; url
       slurp
       (.apply ^Function f)
       frequencies
       (sort-by val)
       reverse
       (into [] (take 10))))</pre>
			</div>
						<div class="box section">
				<p>Receives a Java List of urls and a closure filling the Java Function interface,  </p><p> returns a Java Map of given urls to the top 10 char count ranking, in descending order</p>
			</div>
			<div class="box section">
				<pre class="brush: clojure">(defn -funky
  ^Map [^List i ^Function f]
  (let [top-chars' (partial top-chars f)]
    (into {} (map (juxt identity top-chars')) i)))</pre>
			</div>
						<div class="box section">
				<p>Given a Java List with the tuples of chars and their counts,  </p><p> and returns a String containing a table ranking of those</p>
			</div>
			<div class="box section">
				<pre class="brush: clojure">(defn -printer
  ^String [^List counts]
  (-&gt;&gt; counts
       (mapv (partial zipmap ['char 'count]))
       print-table
       with-out-str))</pre>
			</div>
			
			<div class="box footer">
				Generated by <a href="https://github.com/captain-porcelain/sidenotes">Sidenotes</a>.
				&nbsp;&nbsp;
				Syntax highlighting provided by Alex Gorbatchev's <a href="http://alexgorbatchev.com/SyntaxHighlighter/">SyntaxHighlighter</a>
			</div>
		</div>
		<script type="text/javascript" src="js/app.js"></script>
	</body>
</html>
